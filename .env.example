# ================================
# DuLiDay 企业微信智能服务 - 环境变量配置
# ================================
# 注意：只保留需要用户配置的环境变量
# 其他配置使用合理的默认值，无需手动配置

# ================================
# 应用配置
# ================================
PORT=8080
NODE_ENV=development

# ================================
# Agent API 配置（AI 智能回复服务）
# ================================
# Agent API 密钥（必填）
AGENT_API_KEY=your-api-key-here

# Agent API 基地址（必填）
AGENT_API_BASE_URL=http://localhost:3000/api/v1

# AI 模型配置（必填）
AGENT_DEFAULT_MODEL=anthropic/claude-3-5-haiku-latest
AGENT_CHAT_MODEL=anthropic/claude-sonnet-4-5-20250929
AGENT_CLASSIFY_MODEL=openai/gpt-4o
AGENT_REPLY_MODEL=openai/gpt-5-chat-latest

# 允许使用的工具列表（必填，逗号分隔）
AGENT_ALLOWED_TOOLS=duliday_job_list,duliday_job_details,duliday_interview_booking

# ================================
# Supabase 品牌配置存储（必填）
# ================================
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
SUPABASE_BUCKET_NAME=brand-configs
SUPABASE_BRAND_CONFIG_PATH=config/brand-data.json

# ================================
# Redis 缓存配置（必填）
# ================================
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-token-here

# ================================
# DuLiDay API 配置（必填）
# ================================
DULIDAY_API_TOKEN=your-duliday-token-here

# ================================
# 托管平台 API 配置（必填）
# ================================
STRIDE_API_BASE_URL=https://stride-bg.dpclouds.com
STRIDE_ENTERPRISE_API_BASE_URL=https://stride-bg.dpclouds.com/hub-api

# ================================
# 飞书告警配置（可选）
# ================================
# 启用飞书告警（默认 false）
ENABLE_FEISHU_ALERT=false
# 飞书机器人 Webhook URL
FEISHU_ALERT_WEBHOOK_URL=
# 飞书机器人签名密钥（可选）
FEISHU_ALERT_SECRET=

# ================================
# Bull 队列配置（可选，生产环境建议启用）
# ================================
# 启用 Bull 队列（默认 false，使用内存队列）
ENABLE_BULL_QUEUE=false
# Upstash Redis TCP 连接（启用 Bull 队列时必填）
# UPSTASH_REDIS_TCP_URL=rediss://default:password@your-redis.upstash.io:6379

# ================================
# 以下配置使用默认值，一般无需修改
# ================================

# --- AI 回复配置 ---
# ENABLE_AI_REPLY=true                 # 启用 AI 回复（默认 true）

# --- Agent API 配置 ---
# AGENT_API_TIMEOUT=600000             # Agent API 超时（默认 10min）
# AGENT_API_MAX_RETRIES=5              # 最大重试次数（默认 5）
# AGENT_RESPONSE_CACHE_TTL_SECONDS=3600  # 响应缓存 TTL（默认 1 小时）
# AGENT_RESPONSE_CACHE_MAX_ITEM_SIZE_KB=100  # 单条缓存最大大小（默认 100KB）

# --- 消息聚合配置 ---
# ENABLE_MESSAGE_MERGE=true            # 启用消息聚合（默认 true）
# INITIAL_MERGE_WINDOW_MS=1000         # 聚合等待时间（默认 1s）
# MAX_MERGED_MESSAGES=3                # 最大聚合条数（默认 3）
# MAX_RETRY_COUNT=1                    # Agent 响应后重试次数（默认 1）
# MIN_MESSAGE_LENGTH_TO_RETRY=2        # 触发重试的最小字符数（默认 2）
# COLLECT_MESSAGES_DURING_PROCESSING=true  # Agent 处理期间收集新消息（默认 true）
# OVERFLOW_STRATEGY=take-latest        # 消息超限策略（默认 take-latest）

# --- 消息发送配置 ---
# ENABLE_MESSAGE_SPLIT_SEND=true       # 启用消息分段（默认 true）

# --- 智能打字延迟配置 ---
# TYPING_SPEED_CHARS_PER_SEC=8         # 打字速度（默认 8 字符/秒）
# TYPING_MIN_DELAY_MS=800              # 最小延迟（默认 800ms）
# TYPING_MAX_DELAY_MS=8000             # 最大延迟（默认 8s）
# TYPING_RANDOM_VARIATION=0.2          # 随机波动（默认 ±20%）
# TYPING_THINKING_TIME_MIN_MS=1000     # 思考时间最小值（默认 1s）
# TYPING_THINKING_TIME_MAX_MS=3000     # 思考时间最大值（默认 3s）
# ENABLE_TYPING_THINKING_TIME=true     # 启用思考时间（默认 true）

# --- 消息历史配置 ---
# MAX_HISTORY_PER_CHAT=60              # 每会话最大历史（默认 60）
# HISTORY_TTL_MS=7200000               # 历史过期时间（默认 2 小时）

# --- HTTP 配置 ---
# HTTP_CLIENT_TIMEOUT=30000            # HTTP 超时（默认 30s）
